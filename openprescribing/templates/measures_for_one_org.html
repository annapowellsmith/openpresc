{% extends "base.html" %}
{% load humanize %}
{% load template_extras %}

{% block title %}Prescribing measures for {{ org.name }}{% endblock %}
{% block active_class %}{{ org_type|lower }}{% endblock %}

{% block extra_css %}
<link href='https://api.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />
{% endblock extra_css %}

{% block content %}

<h1>{{ org_type }}: {{ org.name }}</h1>

<div class="row" id="intro">
  {% if org_type == 'CCG' %}
  <div class="col-md-6">
    <p>Standard practices currently in this {{ org_type }}:</p>
    <ul class="list-unstyled" id="practices">
    {% for p in practices %}
      <li
        {% if forloop.counter > 6 %}
          class='hidden'
        {% endif %}
        >
        <a href="{% url 'practice_home_page' p.code %}">{{ p }}</a>
        ({{ p.get_setting_display }}{{ p.inactive_status_suffix }})
      </li>
    {% endfor %}
    </ul>
    {% if practices.count > 6 %}
      <a id="showall" href="#">&raquo; show all {{ practices.count }}  practices...</a>
    {% endif %}
  </div>
  <div class="col-md-6" id="map-container">
    <div id="map-measure"></div>
  </div>
  {% elif org_type == 'STP' %}
  <div class="col-md-6">
    <p>CCGs in this STP:</p>
    <ul class="list-unstyled" id="ccgs">
    {% for ccg in ccgs %}
      <li>
        <a href="{% url 'ccg_home_page' ccg.code %}">{{ ccg }}</a>
      </li>
    {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>

<hr/>

{% include '_measures_heading.html' %}
{% include '_measures_panel.html' %}

<hr/>

{% include '_get_in_touch.html' %}
{% endblock %}

{% block extra_js %}
<script>
 var measureData = {
    'tags': '{{ tag_filter.tags|join:"," }}',
    'orgId': '{{ org.code }}',
    'orgName': '{{ org.name }}',
    'orgType': '{{ org_type }}'
};
</script>
{% conditional_js 'measures' %}

{% endblock %}
